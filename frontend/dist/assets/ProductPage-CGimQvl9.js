import{d as I,r as m,u as p,b as F,f as P,S as k,j as o,T as D,o as q,g as y,h as B,i as U,k as V,D as z,l as R,n as G,p as O,q as W,t as H,L as Y,v as J,c as L,w as K,x as Q,y as X,z as $,e as Z}from"./index-C11wumtl.js";import{B as oo,S as eo}from"./Subscribe-BnlkrmC4.js";import{a as E,S as M}from"./selectors-Snw4L-vK.js";import{s as l,F as no}from"./FeedbacksItem-BSQnx93Y.js";import{f as C}from"./formatNumbers-DT4AwJLE.js";import{n as so}from"./normalizeWordsForm-COjRfoeh.js";import{O as io}from"./onClickAddToCart-DampJG9h.js";import{S as T}from"./index-Ci9XO1VX.js";import{L as _o}from"./LightboxModal-DX_AvvM4.js";import{C as to}from"./Card-Bu-O8JS3.js";import"./vendor-Bhkat8eV.js";const ao=(e=".")=>{let i=new Date,r=i.getDate(),t=i.getMonth()+1,a=i.getFullYear();return`${r}${e}${t<10?`0${t}`:`${t}`}${e}${a}`},ro=(e=":")=>{let i=new Date,r=i.getHours(),t=i.getMinutes();return`${r<10?`0${r}`:`${r}`}${e}${t<10?`0${t}`:`${t}`}`},co=({product:e})=>{const i=I(),[r,t]=m.useState([]),{user:a}=p(F),{feedbackRating:c,feedbacks:d,status:f,feedbacksAll:u,statusAll:g}=p(E),{isLogged:x}=p(F),{register:b,formState:{errors:h},handleSubmit:N}=P({mode:"onBlur",resolver:q(G)});m.useEffect(()=>{x&&f===k.SUCCESS?t(d.filter(s=>s.productId===e.id)):g===k.SUCCESS&&t(u.filter(s=>s.productId===e.id))},[]);const S=async s=>{i(y(""));const j={productId:e.id,date:ao(),time:ro(),rating:c,userId:a.id,userEmail:a.email,userName:a.name,feedbackMessage:s.feedbackMessage},w=await i(B(j));if("error"in w){const A=w.payload||w.error.message;i(y(A))}else await i(U()),i(y(V.successAddedFeedback)),window.location.reload(),z(!0,e,W,O)},_=()=>{i(R(!0))};return o.jsx(o.Fragment,{children:o.jsxs("section",{className:l.product_feedback,id:"feedbacks",children:[o.jsx("div",{className:"title_head",children:o.jsx("h2",{className:"title_head__title",children:"Отзывы"})}),o.jsxs("div",{className:l.product_feedback__inner,children:[r?.length>0?o.jsx("div",{className:l.product_feedback__items,children:r.map((s,j)=>o.jsx(no,{item:s,ix:j},j))}):o.jsx("p",{className:l.product_feedback__inner_text,children:"Нет никаких отзывов на этот продукт."}),x?o.jsxs("form",{className:l.product_feedback__inner_form,onSubmit:N(S),children:[o.jsx("div",{className:l.product_feedback__inner_title,children:"Добавить ваш отзыв"}),o.jsxs("div",{className:l.product_feedback__inner_ratebox,children:[o.jsx("p",{className:l.product_feedback__inner_text,children:"Рейтинг"}),o.jsx(M,{rating:c,editValue:!0})]}),o.jsxs("div",{className:l.product_feedback__form_box,children:[o.jsx(D,{className:l.product_feedback__form_textarea,label:"Напишите ваш отзыв",...b("feedbackMessage"),variant:"outlined",multiline:!0,rows:5,error:!!h.feedbackMessage,helperText:h.feedbackMessage?`${h.feedbackMessage.message}`:""}),o.jsx("button",{className:l.product_feedback__form_button,type:"submit",children:"Отправить"})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("p",{className:l.isNoLogged,children:"Выполните вход, для того чтобы оставить ваш отзыв."}),o.jsx("button",{className:l.login,onClick:()=>_(),children:"Войти"})]})]})]})})},lo="_product_info__images_image_1yepn_1",fo="_product_info__images_slide_1yepn_10",mo="_product_info__image_expand_1yepn_22",v={product_info__images_image:lo,product_info__images_slide:fo,product_info__image_expand:mo},uo=({product:e})=>{const r={slidesToShow:1,slidesToScroll:1,lazyLoad:"ondemand",infinite:!0,arrows:!1,fade:!0},t={slidesToShow:(e.slides?.length||0)<=4?e.slides?.length||1:4,slidesToScroll:1,lazyLoad:"ondemand",infinite:!0},[a,c]=m.useState(null),[d,f]=m.useState(null),[u,g]=m.useState(null),[x,b]=m.useState(0),h=(_,s)=>{g(_),b(s)},N=()=>{const _=e.slides?.length;if(!_)return 0;if(!e.slides)return;const s=x===0?_-1:x-1;g(e.slides[s]),b(s)},S=()=>{const _=e.slides?.length;if(!_)return 0;if(!e.slides)return;const s=(x+1)%_;g(e.slides[s]),b(s)};return o.jsxs(o.Fragment,{children:[o.jsx(T,{className:"product_info__images_image",...r,asNavFor:d??void 0,ref:_=>c(_),children:e.slides?.map((_,s)=>o.jsxs("div",{className:v.product_info__images_image,onClick:()=>h(_,s),children:[o.jsx("img",{src:_,alt:"изображение товара"}),o.jsx("span",{className:v.product_info__image_expand})]},s))}),o.jsx(T,{className:"product_info__images_slider",...t,asNavFor:a??void 0,ref:_=>f(_),children:e.slides?.map((_,s)=>o.jsx("div",{className:v.product_info__images_slide,onClick:()=>h(_,s),children:o.jsx("img",{src:_,alt:"миниатюра"})},s))}),u&&o.jsx(_o,{clickedImage:u,imageNext:S,imagePrev:N,setClickedImage:g})]})},po="_product_info_2n5p9_1",go="_product_info__inner_2n5p9_19",xo="_product_info__inner_images_2n5p9_30",ho="_product_info__inner_information_2n5p9_35",bo="_product_info__information_name_box_2n5p9_41",jo="_product_info__information_rate_2n5p9_49",ko="_product_info__information_name_2n5p9_41",No="_product_info__information_feedbacks_2n5p9_63",So="_product_info__information_addfeedbacks_2n5p9_71",wo="_product_info__information_price_box_2n5p9_82",yo="_product_info__information_price_2n5p9_82",vo="_product_info__information_price_span_2n5p9_96",Fo="_product_info__information_buy_box_2n5p9_106",To="_product_info__card__form_button_2n5p9_115",$o="_product_info__information_text_box_2n5p9_212",Co="_product_info__information_text_title_2n5p9_222",Io="_product_info__information_category_box_2n5p9_228",Lo="_product_info__information_category_line_2n5p9_238",Eo="_green_2n5p9_247",Mo="_red_2n5p9_250",Ao="_color_2n5p9_254",Po="_product_info__information_category_span_2n5p9_268",Do="_product_info__information_socials_box_2n5p9_276",qo="_product_info__information_socials_item_2n5p9_283",n={product_info:po,product_info__inner:go,product_info__inner_images:xo,product_info__inner_information:ho,product_info__information_name_box:bo,product_info__information_rate:jo,product_info__information_name:ko,product_info__information_feedbacks:No,product_info__information_addfeedbacks:So,product_info__information_price_box:wo,product_info__information_price:yo,product_info__information_price_span:vo,product_info__information_buy_box:Fo,product_info__card__form_button:To,product_info__information_text_box:$o,product_info__information_text_title:Co,product_info__information_category_box:Io,product_info__information_category_line:Lo,green:Eo,red:Mo,color:Ao,product_info__information_category_span:Po,product_info__information_socials_box:Do,product_info__information_socials_item:qo},Bo=({product:e})=>{const{status:i,feedbacksAll:r}=p(E),{isLogged:t}=p(F),{hash:a,key:c}=H();m.useEffect(()=>{window.scrollTo(0,0)},[]),m.useEffect(()=>{a&&a.length>1&&document.getElementById(a.substring(1))?.scrollIntoView({behavior:"smooth"})},[c,a]);const d=i===k.SUCCESS?r.filter(f=>f.productId===e.id):[];return o.jsx(o.Fragment,{children:o.jsx("section",{className:n.product_info,children:o.jsxs("div",{className:n.product_info__inner,children:[o.jsx("div",{className:n.product_info__inner_images,children:o.jsx(uo,{product:e})}),o.jsxs("div",{className:n.product_info__inner_information,children:[o.jsxs("div",{className:n.product_info__information_name_box,children:[o.jsx("div",{className:n.product_info__information_name,children:e?.name}),o.jsx("div",{className:n.product_info__information_rate,children:o.jsx(M,{rating:e?.rating,editValue:!1})}),o.jsxs("div",{className:n.product_info__information_feedbacks,children:[d.length,so(d.length)]}),o.jsx(Y,{className:n.product_info__information_addfeedbacks,to:"#feedbacks",children:"Добавить отзыв"})]}),o.jsx("div",{className:n.product_info__information_price_box,children:o.jsxs("div",{className:n.product_info__information_price,children:[C(e?.price)," р",o.jsxs("span",{className:n.product_info__information_price_span,children:[C(e?.salePrice)," р"]})]})}),t&&o.jsx("div",{className:n.product_info__information_buy_box,children:o.jsxs("button",{className:n.product_info__card__form_button,type:"button",onClick:()=>io(e),children:[o.jsx("i",{className:"icon_shopping_basket"}),"В корзину"]})}),o.jsxs("div",{className:n.product_info__information_text_box,children:[o.jsx("div",{className:n.product_info__information_text_title,children:"Описание:"}),e?.description]}),o.jsxs("div",{className:n.product_info__information_category_box,children:[o.jsxs("div",{className:n.product_info__information_category_line,children:[o.jsx("span",{className:n.product_info__information_category_span,children:"Доступно:"}),o.jsx("strong",{className:e?.inStock?n.green:n.red,children:e?.inStock?"В наличии":"Нет в наличии"})]}),o.jsxs("div",{className:n.product_info__information_category_line,children:[o.jsx("span",{className:n.product_info__information_category_span,children:"Категория:"}),J[e?.category]?.name]}),o.jsxs("div",{className:n.product_info__information_category_line,children:[o.jsx("span",{className:n.product_info__information_category_span,children:"Цвет:"}),o.jsx("span",{className:n.color,style:{backgroundColor:`${e?.color}`}})]})]}),o.jsxs("div",{className:n.product_info__information_socials_box,children:[o.jsx("a",{className:`${n.product_info__information_socials_item} icon_facebook_square socials__color_facebook`,href:"https://www.facebook.com/",children:"Facebook"}),o.jsx("a",{className:`${n.product_info__information_socials_item} icon_twitter_square socials__color_twitter`,href:"https://help.twitter.com/",children:"Tweet"}),o.jsx("a",{className:`${n.product_info__information_socials_item} icon_linkedin_square socials__color_linkedin`,href:"https://www.linkedin.com/",children:"Linkedin"}),o.jsx("a",{className:`${n.product_info__information_socials_item} icon_google_plus_square socials__color_google`,href:"https://www.google.ru/",children:"Google+"}),o.jsx("a",{className:`${n.product_info__information_socials_item} icon_pinterest_square socials__color_pinterest`,href:"https://www.pinterest.ru/",children:"Pinterest"})]})]})]})})})},Uo="_popular_1trw8_1",Vo={popular:Uo},zo=({category:e})=>{const{productsAll:i}=p(L),t=((c,d,f)=>c.filter(u=>u[d]===f))(i,"category",e),a={slidesToShow:4,slidesToScroll:4,arrows:!1,dots:!0,autoplay:!0,autoplaySpeed:3500,cssEase:"ease-out",responsive:[{breakpoint:1251,settings:{slidesToShow:3,slidesToScroll:3,variableWidth:!1}},{breakpoint:801,settings:{slidesToShow:2,slidesToScroll:2,variableWidth:!1}},{breakpoint:551,settings:{slidesToShow:1,slidesToScroll:1,variableWidth:!1}}]};return o.jsxs("section",{className:Vo.popular,children:[o.jsx("div",{className:"title_head",children:o.jsx("h2",{className:"title_head__title",children:"Популярное"})}),o.jsx(T,{className:"popular__slider",...a,children:t.map(c=>o.jsx(to,{product:c},c.id))})]})},oe=()=>{const e=I(),i=K(),{productsAll:r,statusAll:t}=p(L),{menuUrlValue:a}=p(Q),{id:c}=X(),d=r?.find(u=>u.id===Number(c)),f=d?.name;return m.useEffect(()=>{e($(!1)),e(Z(""))},[a,e]),m.useEffect(()=>{window.scrollTo(0,0),e($(!1))},[c,e]),o.jsx(o.Fragment,{children:t===k.LOADING?"Идёт загрузка!":o.jsxs(o.Fragment,{children:[o.jsx(oo,{pageTitle:f}),d?o.jsxs(o.Fragment,{children:[o.jsx(Bo,{product:d}),o.jsx(co,{product:d}),o.jsx(zo,{category:d?.category})]}):i("error"),o.jsx(eo,{})]})})};export{oe as default};
